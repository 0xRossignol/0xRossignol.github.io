<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>标签: Golang - MyBlog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="MyBlog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="MyBlog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="MyBlog"><meta property="og:url" content="http://example.com/"><meta property="og:site_name" content="MyBlog"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:author" content="Rossignol"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://example.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"MyBlog","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"Rossignol"},"publisher":{"@type":"Organization","name":"MyBlog","logo":{"@type":"ImageObject","url":"http://example.com/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="MyBlog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xRossignol"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags/">标签</a></li><li class="is-active"><a href="#" aria-current="page">Golang</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-12-24T04:55:24.000Z" title="2024/12/24 12:55:24">2024-12-24</time>发表</span><span class="level-item"><time dateTime="2025-01-02T08:59:58.312Z" title="2025/1/2 16:59:58">2025-01-02</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Golang/">Golang</a><span> / </span><a class="link-muted" href="/categories/Golang/basics/">basics</a></span><span class="level-item">18 分钟读完 (大约2724个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/12/24/goByExample/goByExample-pt-3/">goByExample pt.3</a></p><div class="content"><h2 id="Interfaces"><a href="#Interfaces" class="headerlink" title="Interfaces"></a>Interfaces</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Interfaces</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;math&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> geometry <span class="keyword">interface</span> &#123;</span><br><span class="line">    area() <span class="type">float64</span></span><br><span class="line">    perim() <span class="type">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> rect <span class="keyword">struct</span> &#123;</span><br><span class="line">    width, height <span class="type">float64</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> circle <span class="keyword">struct</span> &#123;</span><br><span class="line">    radius <span class="type">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r rect)</span></span> area() <span class="type">float64</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> r.width * r.height</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r rect)</span></span> perim() <span class="type">float64</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>*r.width + <span class="number">2</span>*r.height</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c circle)</span></span> area() <span class="type">float64</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> math.Pi * c.radius * c.radius</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c circle)</span></span> perim() <span class="type">float64</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> * math.Pi * c.radius</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">measure</span><span class="params">(g geometry)</span></span> &#123;</span><br><span class="line">    fmt.Println(g)</span><br><span class="line">    fmt.Println(g.area())</span><br><span class="line">    fmt.Println(g.perim())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := rect&#123;width: <span class="number">3</span>, height: <span class="number">4</span>&#125;</span><br><span class="line">    c := circle&#123;radius: <span class="number">5</span>&#125;</span><br><span class="line"></span><br><span class="line">    measure(r)</span><br><span class="line">    measure(c)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>Interfaces</em> are named collections of method signatures.</p>
<p>Here’s a basic interface for geometric shapes.</p>
<p>For our example we’ll implement this interface on <code>rect</code> and <code>circle</code> types.</p>
<p>To implement an interface in Go, we just need to implement all the methods in the interface. Here we implement <code>geometry</code> on <code>rect</code>s.</p>
<p>The implementation for <code>circle</code>s.</p>
<p>If a variable has an interface type, then we can call methods that are in the named interface. Here’s a generic <code>measure</code> function taking advantage of this to work on any <code>geometry</code>.</p>
<p>The <code>circle</code> and <code>rect</code> struct types both implement the <code>geometry</code> interface so we can use instances of these structs as arguments to <code>measure</code>.</p>
<p>To learn more about Go’s interfaces, check out this <a target="_blank" rel="noopener" href="https://jordanorelli.tumblr.com/post/32665860244/how-to-use-interfaces-in-go">great blog post (maybe another blog)</a>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run .\21.Interfaces.go</span><br><span class="line">&#123;3 4&#125;</span><br><span class="line">12</span><br><span class="line">14</span><br><span class="line">&#123;5&#125;</span><br><span class="line">78.53981633974483</span><br><span class="line">31.41592653589793</span><br></pre></td></tr></table></figure>

<h2 id="Enums"><a href="#Enums" class="headerlink" title="Enums"></a>Enums</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Enums</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> ServerState <span class="type">int</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">    StateIdle ServerState = <span class="literal">iota</span></span><br><span class="line">    StateConnected</span><br><span class="line">    StateError</span><br><span class="line">    StateRetrying</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stateName = <span class="keyword">map</span>[ServerState]<span class="type">string</span>&#123;</span><br><span class="line">    StateIdle:      <span class="string">&quot;idle&quot;</span>,</span><br><span class="line">    StateConnected: <span class="string">&quot;connected&quot;</span>,</span><br><span class="line">    StateError:     <span class="string">&quot;error&quot;</span>,</span><br><span class="line">    StateRetrying:  <span class="string">&quot;retrying&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ss ServerState)</span></span> String() <span class="type">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> stateName[ss]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    ns := transition(StateIdle)</span><br><span class="line">    fmt.Println(ns)</span><br><span class="line"></span><br><span class="line">    ns2 := transition(ns)</span><br><span class="line">    fmt.Println(ns2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">transition</span><span class="params">(s ServerState)</span></span> ServerState &#123;</span><br><span class="line">    <span class="keyword">switch</span> s &#123;</span><br><span class="line">    <span class="keyword">case</span> StateIdle:</span><br><span class="line">        <span class="keyword">return</span> StateConnected</span><br><span class="line">    <span class="keyword">case</span> StateConnected, StateRetrying:</span><br><span class="line">        <span class="keyword">return</span> StateIdle</span><br><span class="line">    <span class="keyword">case</span> StateError:</span><br><span class="line">        <span class="keyword">return</span> StateError</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">panic</span>(fmt.Errorf(<span class="string">&quot;unknown state: %s&quot;</span>, s))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>Enumerated types</em> (enums) are a special case of <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Algebraic_data_type">sum types</a>. An enum is a type that has a fixed number of possible values, each with a distinct name. Go doesn’t have an enum type as a distinct language feature, but enums are simple to implement using existing language idioms.</p>
<p>Our enum type <code>ServerState</code> has an underlying <code>int</code> type.</p>
<p>The possible values for <code>ServerState</code> are defined as constants. The special keyword <a target="_blank" rel="noopener" href="https://go.dev/ref/spec#Iota">iota</a> generates <em>successive (连续 )</em> constant values automatically; in this case 0, 1, 2 and so on.</p>
<p>特殊关键字 iota 自动生成连续的常量值；在本例中为 0、1、2 等等。</p>
<p>By implementing the <a href="###fmt.Stringer">fmt.Stringer</a> interface, values of <code>ServerState</code> can be printed out or converted to strings.</p>
<p>通过实现 fmt.Stringer 接口，可以打印出 ServerState 的值或将其转换为字符串。</p>
<p>This can get <em>cumbersome (繁琐 )</em> if there are many possible values. In such cases the [stringer tool](###stringer tool) can be used in conjunction with <code>go:generate</code> to automate the process. See <a target="_blank" rel="noopener" href="https://eli.thegreenplace.net/2021/a-comprehensive-guide-to-go-generate">this post(maybe another blog)</a> for a longer explanation.</p>
<p>如果可能的值太多，这可能会变得很麻烦。在这种情况下，stringer 工具可以与 go:generate 结合使用来自动化该过程。</p>
<p>If we have a value of type <code>int</code>, we cannot pass it to <code>transition</code> - the compiler will complain about type mismatch. This provides some degree of compile-time type safety for enums.</p>
<p>transition emulates a state transition for a server; it takes the existing state and returns a new state.</p>
<p>Suppose we check some predicates here to determine the next state…</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run .\22.Enums.go     </span><br><span class="line">connected</span><br><span class="line">idle</span><br></pre></td></tr></table></figure>

<h2 id="Struct-Embedding"><a href="#Struct-Embedding" class="headerlink" title="Struct Embedding"></a>Struct Embedding</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Struct Embedding</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> base <span class="keyword">struct</span> &#123;</span><br><span class="line">    num <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b base)</span></span> describe() <span class="type">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;base with num=%v&quot;</span>, b.num)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> container <span class="keyword">struct</span> &#123;</span><br><span class="line">    base</span><br><span class="line">    str <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    co := container&#123;</span><br><span class="line">        base: base&#123;</span><br><span class="line">            num: <span class="number">1</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        str: <span class="string">&quot;some name&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fmt.Printf(<span class="string">&quot;co=&#123;num: %v, str: %v&#125;\n&quot;</span>, co.num, co.str)</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;also num:&quot;</span>, co.base.num)</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;describe:&quot;</span>, co.describe())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">type</span> describer <span class="keyword">interface</span> &#123;</span><br><span class="line">        describe() <span class="type">string</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> d describer = co</span><br><span class="line">    fmt.Println(<span class="string">&quot;describer:&quot;</span>, d.describe())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Go supports <em>embedding (嵌入 )</em> of structs and interfaces to express a more <em>seamless (无缝的 )</em> <em>composition</em> of types. This is not to be confused with <a target="_blank" rel="noopener" href="https://gobyexample.com/embed-directive"><code>//go:embed</code></a> which is a <em>go directive introduced (go 指令 )</em> in Go version 1.16+ to embed files and folders into the application binary.</p>
<p>A <code>container</code> <em>embeds</em> a <code>base</code>. An embedding looks like a field without a name.</p>
<p>When creating structs with literals, we have to initialize the embedding explicitly; here the embedded type serves as the field name.</p>
<p>We can access the base’s fields directly on <code>co</code>, e.g. <code>co.num</code>.</p>
<p>Alternatively, we can spell out the full path using the embedded type name.</p>
<p>Since <code>container</code> embeds <code>base</code>, the methods of <code>base</code> also become methods of a <code>container</code>. Here we invoke a method that was embedded from <code>base</code> directly on <code>co</code>.</p>
<p>Embedding structs with methods may be used to <em>bestow (赋予 )</em> interface implementations onto other structs. Here we see that a <code>container</code> now implements the <code>describer</code> interface because it embeds <code>base</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run <span class="string">&#x27;.\23.Struct Embedding.go&#x27;</span></span><br><span class="line">co=&#123;num: 1, str: some name&#125;</span><br><span class="line">also num: 1</span><br><span class="line">describe: base with num=1</span><br><span class="line">describer: base with num=1</span><br></pre></td></tr></table></figure>

<h2 id="Generics-泛型"><a href="#Generics-泛型" class="headerlink" title="Generics(泛型)"></a>Generics(泛型)</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Generics</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SlicesIndex</span>[<span class="title">S</span> ~[]<span class="title">E</span>, <span class="title">E</span> <span class="title">comparable</span>]<span class="params">(s S, v E)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="keyword">range</span> s &#123;</span><br><span class="line">        <span class="keyword">if</span> v == s[i] &#123;</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> List[T any] <span class="keyword">struct</span> &#123;</span><br><span class="line">    head, tail *element[T]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> element[T any] <span class="keyword">struct</span> &#123;</span><br><span class="line">    next *element[T]</span><br><span class="line">    val  T</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(lst *List[T])</span></span> Push(v T) &#123;</span><br><span class="line">    <span class="keyword">if</span> lst.tail == <span class="literal">nil</span> &#123;</span><br><span class="line">        lst.head = &amp;element[T]&#123;val: v&#125;</span><br><span class="line">        lst.tail = lst.head</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        lst.tail.next = &amp;element[T]&#123;val: v&#125;</span><br><span class="line">        lst.tail = lst.tail.next</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(lst *List[T])</span></span> AllElements() []T &#123;</span><br><span class="line">    <span class="keyword">var</span> elems []T</span><br><span class="line">    <span class="keyword">for</span> e := lst.head; e != <span class="literal">nil</span>; e = e.next &#123;</span><br><span class="line">        elems = <span class="built_in">append</span>(elems, e.val)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> elems</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> s = []<span class="type">string</span>&#123;<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;zoo&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;index of zoo:&quot;</span>, SlicesIndex(s, <span class="string">&quot;zoo&quot;</span>))</span><br><span class="line"></span><br><span class="line">    _ = SlicesIndex[[]<span class="type">string</span>, <span class="type">string</span>](s, <span class="string">&quot;zoo&quot;</span>)</span><br><span class="line"></span><br><span class="line">    lst := List[<span class="type">int</span>]&#123;&#125;</span><br><span class="line">    lst.Push(<span class="number">10</span>)</span><br><span class="line">    lst.Push(<span class="number">13</span>)</span><br><span class="line">    lst.Push(<span class="number">23</span>)</span><br><span class="line">    fmt.Println(<span class="string">&quot;list:&quot;</span>, lst.AllElements())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Starting with version 1.18, Go has added support for <em>generics</em>, also known as <em>type parameters</em>.</p>
<p>As an example of a generic function, <code>SlicesIndex</code> takes a slice of any <code>comparable</code> type and an element of that type and returns the index of the first occurrence of v in s, or -1 if not present. The <code>comparable</code> constraint means that we can compare values of this type with the <code>==</code> and <code>!=</code> operators. For a more thorough explanation of this type signature, see <a target="_blank" rel="noopener" href="https://go.dev/blog/deconstructing-type-parameters">this blog post (maybe another blog)</a>. Note that this function exists in the standard library as <a href="###slices.Index">slices.Index</a>.</p>
<p>As an example of a generic type, <code>List</code> is a singly-linked list with values of any type.</p>
<p>We can define methods on generic types just like we do on regular types, but we have to keep the type parameters in place. The type is <code>List[T]</code>, not <code>List</code>.</p>
<p>AllElements returns all the List elements as a slice. In the next example we’ll see a more idiomatic way of iterating over all elements of custom types.</p>
<p>When invoking generic functions, we can often rely on <em>type inference</em>. Note that we don’t have to specify the types for <code>S</code> and <code>E</code> when calling <code>SlicesIndex</code> - the compiler infers them automatically.</p>
<p>… though we could also specify them explicitly.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run <span class="string">&#x27;.\24.generics.go&#x27;</span>        </span><br><span class="line">index of zoo: 2</span><br><span class="line">list: [10 13 23]</span><br></pre></td></tr></table></figure>

<h2 id="Range-over-Iterators"><a href="#Range-over-Iterators" class="headerlink" title="Range over Iterators"></a>Range over Iterators</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Range over Iterators</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;iter&quot;</span></span><br><span class="line">    <span class="string">&quot;slices&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> List[T any] <span class="keyword">struct</span> &#123;</span><br><span class="line">    head, tail *element[T]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> element[T any] <span class="keyword">struct</span> &#123;</span><br><span class="line">    next *element[T]</span><br><span class="line">    val  T</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(lst *List[T])</span></span> Push(v T) &#123;</span><br><span class="line">    <span class="keyword">if</span> lst.tail == <span class="literal">nil</span> &#123;</span><br><span class="line">        lst.head = &amp;element[T]&#123;val: v&#125;</span><br><span class="line">        lst.tail = lst.head</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        lst.tail.next = &amp;element[T]&#123;val: v&#125;</span><br><span class="line">        lst.tail = lst.tail.next</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(lst *List[T])</span></span> All() iter.Seq[T] &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(yield <span class="keyword">func</span>(T)</span></span> <span class="type">bool</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> e := lst.head; e != <span class="literal">nil</span>; e = e.next &#123;</span><br><span class="line">            <span class="keyword">if</span> !yield(e.val) &#123;</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">genFib</span><span class="params">()</span></span> iter.Seq[<span class="type">int</span>] &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(yield <span class="keyword">func</span>(<span class="type">int</span>)</span></span> <span class="type">bool</span>) &#123;</span><br><span class="line">        a, b := <span class="number">1</span>, <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> !yield(a) &#123;</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            a, b = b, a+b</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    lst := List[<span class="type">int</span>]&#123;&#125;</span><br><span class="line">    lst.Push(<span class="number">10</span>)</span><br><span class="line">    lst.Push(<span class="number">13</span>)</span><br><span class="line">    lst.Push(<span class="number">23</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> e := <span class="keyword">range</span> lst.All() &#123;</span><br><span class="line">        fmt.Println(e)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    all := slices.Collect(lst.All())</span><br><span class="line">    fmt.Println(<span class="string">&quot;all:&quot;</span>, all)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> n := <span class="keyword">range</span> genFib() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> n &gt;= <span class="number">10</span> &#123;</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">        fmt.Println(n)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Starting with version 1.23, Go has added support for <a target="_blank" rel="noopener" href="https://go.dev/blog/range-functions">iterators</a>, which lets us range over pretty much anything!</p>
<p>Let’s look at the <code>List</code> type from the <a href="##Generics(%E6%B3%9B%E5%9E%8B)">previous example</a> again. In that example we had an <code>AllElements</code> method that returned a slice of all elements in the list. With Go iterators, we can do it better - as shown below.</p>
<p>All returns an <em>iterator</em>, which in Go is a function with a <a target="_blank" rel="noopener" href="https://pkg.go.dev/iter#Seq">special signature</a>.</p>
<p>The iterator function takes another function as a parameter, called <code>yield</code> by convention (but the name can be arbitrary). It will call <code>yield</code> for every element we want to iterate over, and note <code>yield</code>’s return value for a potential early termination.</p>
<p>迭代器函数将另一个函数作为参数，按照惯例称为yield（但名称可以任意）。它将为我们想要迭代的每个元素调用yield，并记录yield的返回值以防可能提前终止。</p>
<p>Iteration doesn’t require an underlying data structure, and doesn’t even have to be finite! Here’s a function returning an iterator over Fibonacci numbers: it keeps running as long as <code>yield</code> keeps returning <code>true</code>.</p>
<p>迭代不需要底层数据结构，甚至不必是有限的！这是一个返回斐波那契数列迭代器的函数：只要yield一直返回true，它就会一直运行。</p>
<p>Since <code>List.All</code> returns an iterator, we can use it in a regular <code>range</code> loop.</p>
<p>Packages like <a target="_blank" rel="noopener" href="https://pkg.go.dev/slices">slices</a> have a number of useful functions to work with iterators. For example, <code>Collect</code> takes any iterator and collects all its values into a slice.</p>
<p>Once the loop hits <code>break</code> or an early return, the <code>yield</code> function passed to the iterator will return <code>false</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run <span class="string">&#x27;.\25.Range over Iterators.go&#x27;</span></span><br><span class="line">10</span><br><span class="line">13</span><br><span class="line">23</span><br><span class="line">all: [10 13 23]</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">5</span><br><span class="line">8</span><br></pre></td></tr></table></figure>

<h2 id="Errors"><a href="#Errors" class="headerlink" title="Errors"></a>Errors</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Errors</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;errors&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">f</span><span class="params">(arg <span class="type">int</span>)</span></span> (<span class="type">int</span>, <span class="type">error</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> arg == <span class="number">42</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>, errors.New(<span class="string">&quot;can&#x27;t work with 42&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> arg + <span class="number">3</span>, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ErrOutOfTea = fmt.Errorf(<span class="string">&quot;no more tea available&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> ErrPower = fmt.Errorf(<span class="string">&quot;can&#x27;t boil water&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">makeTea</span><span class="params">(arg <span class="type">int</span>)</span></span> <span class="type">error</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> arg == <span class="number">2</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ErrOutOfTea</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> arg == <span class="number">4</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;making tea: %w&quot;</span>, ErrPower)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> _, i := <span class="keyword">range</span> []<span class="type">int</span>&#123;<span class="number">7</span>, <span class="number">42</span>&#125; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> r, e := f(i); e != <span class="literal">nil</span> &#123;</span><br><span class="line">            fmt.Println(<span class="string">&quot;f failed:&quot;</span>, e)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            fmt.Println(<span class="string">&quot;f worked:&quot;</span>, r)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i := <span class="keyword">range</span> <span class="number">5</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> err := makeTea(i); err != <span class="literal">nil</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> errors.Is(err, ErrOutOfTea) &#123;</span><br><span class="line">                fmt.Println(<span class="string">&quot;We should buy new tea!&quot;</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> errors.Is(err, ErrPower) &#123;</span><br><span class="line">                fmt.Println(<span class="string">&quot;Now it is dark.&quot;</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                fmt.Printf(<span class="string">&quot;unknown error: %s\n&quot;</span>, err)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        fmt.Println(<span class="string">&quot;Tea is ready!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In Go it’s idiomatic to communicate errors via an explicit, separate return value. This contrasts with the exceptions used in languages like Java and Ruby and the overloaded single result &#x2F; error value sometimes used in C. Go’s approach makes it easy to see which functions return errors and to handle them using the same language constructs employed for other, non-error tasks.</p>
<h2 id="扩展："><a href="#扩展：" class="headerlink" title="扩展："></a>扩展：</h2><h3 id="fmt-Stringer"><a href="#fmt-Stringer" class="headerlink" title="fmt.Stringer"></a>fmt.Stringer</h3><p>官方文档：<a target="_blank" rel="noopener" href="https://pkg.go.dev/fmt#Stringer">fmt.Stringer</a></p>
<p>type <a target="_blank" rel="noopener" href="https://cs.opensource.google/go/go/+/go1.23.4:src/fmt/print.go;l=63">Stringer</a> :</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Stringer <span class="keyword">interface</span> &#123;</span><br><span class="line">	String() <span class="type">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Stringer is implemented by any value that has a String method, which defines the “native” format for that value. The String method is used to print values passed as an operand to any format that accepts a string or to an unformatted printer such as <a target="_blank" rel="noopener" href="https://pkg.go.dev/fmt#Print">Print</a>.</p>
<p>Example:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Animal has a Name and an Age to represent an animal.</span></span><br><span class="line"><span class="keyword">type</span> Animal <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="type">string</span></span><br><span class="line">	Age  <span class="type">uint</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// String makes Animal satisfy the Stringer interface.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a Animal)</span></span> String() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;%v (%d)&quot;</span>, a.Name, a.Age)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	a := Animal&#123;</span><br><span class="line">		Name: <span class="string">&quot;Gopher&quot;</span>,</span><br><span class="line">		Age:  <span class="number">2</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Output:</span><br><span class="line"></span><br><span class="line">Gopher (2)</span><br></pre></td></tr></table></figure>

<h3 id="stringer-tool"><a href="#stringer-tool" class="headerlink" title="stringer tool"></a>stringer tool</h3><p>Stringer is a tool to automate the creation of methods that satisfy the fmt.Stringer interface. Given the name of a (signed or unsigned) integer type T that has constants defined, stringer will create a new self-contained Go source file implementing</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t T)</span></span> String() <span class="type">string</span></span><br></pre></td></tr></table></figure>

<p>The file is created in the same package and directory as the package that defines T. It has helpful defaults designed for use with go generate.</p>
<p>Stringer works best with constants that are consecutive values such as created using iota, but creates good code regardless. In the future it might also provide custom support for constant sets that are bit patterns.</p>
<p>For example, given this snippet,</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> painkiller</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Pill <span class="type">int</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	Placebo Pill = <span class="literal">iota</span></span><br><span class="line">	Aspirin</span><br><span class="line">	Ibuprofen</span><br><span class="line">	Paracetamol</span><br><span class="line">	Acetaminophen = Paracetamol</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>running this command</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stringer -<span class="built_in">type</span>=Pill</span><br></pre></td></tr></table></figure>

<p>in the same directory will create the file pill_string.go, in package painkiller, containing a definition of</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Pill)</span></span> String() <span class="type">string</span></span><br></pre></td></tr></table></figure>

<p>That method will translate the value of a Pill constant to the string representation of the respective constant name, so that the call fmt.Print(painkiller.Aspirin) will print the string “Aspirin”.</p>
<p>Typically this process would be run using go generate, like this:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//go:generate stringer -type=Pill</span></span><br></pre></td></tr></table></figure>

<p>If multiple constants have the same value, the <em>lexically (词汇上 )</em> first matching name will be used (in the example, Acetaminophen will print as “Paracetamol”).</p>
<p>With no arguments, it processes the package in the current directory. Otherwise, the arguments must name a single directory holding a Go package or a set of Go source files that represent a single Go package.</p>
<p>The -type flag accepts a comma-separated list of types so a single run can generate methods for multiple types. The default output file is t_string.go, where t is the lower-cased name of the first type listed. It can be overridden with the -output flag.</p>
<p>Types can also be declared in tests, in which case type declarations in the non-test package or its test variant are preferred over types defined in the package with suffix “_test”. The default output file for type declarations in tests is t_string_test.go with t picked as above.</p>
<p>The -linecomment flag tells stringer to generate the text of any line comment, <em>trimmed of leading spaces (去掉前导空格 )</em>, instead of the constant name. For instance, if the constants above had a Pill prefix, one could write</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PillAspirin <span class="comment">// Aspirin</span></span><br></pre></td></tr></table></figure>

<p>to suppress it in the output.</p>
<h3 id="slices-Index"><a href="#slices-Index" class="headerlink" title="slices.Index"></a>slices.Index</h3><p>func <a target="_blank" rel="noopener" href="https://cs.opensource.google/go/go/+/go1.23.4:src/slices/slices.go;l=96">Index</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Index</span>[<span class="title">S</span> ~[]<span class="title">E</span>, <span class="title">E</span> <span class="title">comparable</span>]<span class="params">(s S, v E)</span></span> <span class="type">int</span></span><br></pre></td></tr></table></figure>

<p>Index returns the index of the first occurrence of v in s, or -1 if not present.</p>
<p>Example:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;slices&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	numbers := []<span class="type">int</span>&#123;<span class="number">0</span>, <span class="number">42</span>, <span class="number">8</span>&#125;</span><br><span class="line">	fmt.Println(slices.Index(numbers, <span class="number">8</span>))</span><br><span class="line">	fmt.Println(slices.Index(numbers, <span class="number">7</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Output:</span><br><span class="line"></span><br><span class="line">2</span><br><span class="line">-1</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-12-23T13:50:26.000Z" title="2024/12/23 21:50:26">2024-12-23</time>发表</span><span class="level-item"><time dateTime="2024-12-23T09:05:27.057Z" title="2024/12/23 17:05:27">2024-12-23</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Golang/">Golang</a><span> / </span><a class="link-muted" href="/categories/Golang/basics/">basics</a></span><span class="level-item">16 分钟读完 (大约2459个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/12/23/goByExample/goByExample-pt-2/">goByExample pt.2</a></p><div class="content"><h2 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Functions</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">plus</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">plusPlus</span><span class="params">(a, b, c <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> a + b + c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	res := plus(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;1 + 2 =&quot;</span>, res)</span><br><span class="line"></span><br><span class="line">	res = plusPlus(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">	fmt.Println( <span class="string">&quot;1 + 2 + 3 =&quot;</span>, res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>Functions</em> are central (核心&#x2F;中心) in Go. We’ll learn about functions with a few different examples.</p>
<p>Here’s a function that takes two <code>int</code>s and returns their sum as an <code>int</code>.</p>
<p>Go requires explicit returns, <em>i.e. (即 )</em> it won’t automatically return the value of the last expression.</p>
<p>When you have multiple <em>consecutive (连续的 )</em> parameters of the same type, you may <em>omit (省略 )</em> the type name for the <em>like-typed (相同类型的 )</em> parameters up to the final parameter that declares the type.</p>
<p>Call a function just as you’d expect, with <code>name(args)</code>.</p>
<p>There are several other features to Go functions. One is <strong>multiple return values</strong>, which we’ll look at next.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run .\11.functions.go</span><br><span class="line">1 + 2 = 3</span><br><span class="line">1 + 2 + 3 = 6</span><br></pre></td></tr></table></figure>

<h2 id="Multiple-Return-Values"><a href="#Multiple-Return-Values" class="headerlink" title="Multiple Return Values"></a>Multiple Return Values</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Multiple Return Values</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">vals</span><span class="params">()</span></span> (<span class="type">int</span>, <span class="type">int</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span>, <span class="number">7</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    a, b := vals()</span><br><span class="line">    fmt.Println(a)</span><br><span class="line">    fmt.Println(b)</span><br><span class="line"></span><br><span class="line">    _, c := vals()</span><br><span class="line">    fmt.Println(c)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Go has built-in support for <em><strong>multiple return values</strong></em>. This feature is used often in idiomatic Go (这个特性在 Go 语言中经常用到), for example to return both result and error values from a function.</p>
<p>The <code>(int, int)</code> in this function signature shows that the function returns 2 <code>int</code>s.</p>
<p>Here we use the 2 different return values from the call with <em>multiple assignment (多赋值操作)</em>.</p>
<p>If you only want a <em>subset (子集 &#x2F; 一部分)</em> of the returned values, use the blank identifier <code>_</code>.</p>
<p>Accepting a <em>variable (可变的 )</em> number of arguments is another nice feature of Go functions; we’ll look at this next.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run <span class="string">&#x27;.\12.multiple return values.go&#x27;</span></span><br><span class="line">3</span><br><span class="line">7</span><br><span class="line">7</span><br></pre></td></tr></table></figure>

<h2 id="Variadic-Functions"><a href="#Variadic-Functions" class="headerlink" title="Variadic Functions"></a>Variadic Functions</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Variadic Functions</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sum</span><span class="params">(nums ...<span class="type">int</span>)</span></span> &#123;</span><br><span class="line">    fmt.Print(nums, <span class="string">&quot; &quot;</span>)</span><br><span class="line">    total := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _, num := <span class="keyword">range</span> nums &#123;</span><br><span class="line">        total += num</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(total)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    sum(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">    sum(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    nums := []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</span><br><span class="line">    sum(nums...)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Variadic_function"><em>Variadic functions</em></a> can be called with any number of <em>trailing (尾随 )</em> arguments. For example, <code>fmt.Println</code> is a common variadic function.</p>
<p>Here’s a function that will take an <em>arbitrary (随意的 )</em> number of <code>int</code>s as arguments.</p>
<p>Within the function, the type of <code>nums</code> is equivalent to <code>[]int</code>. We can call <code>len(nums)</code>, iterate over it with <code>range</code>, etc.</p>
<p><code>for _, num := range nums</code> 解释：</p>
<p><code>range</code> 表达式通常返回两个值：一个是索引，另一个是值。在这段代码中</p>
<ul>
<li><p>第一个值是数组 <code>nums</code> 中每个元素的索引。</p>
</li>
<li><p>第二个值是数组中相应位置的元素值。</p>
</li>
</ul>
<p>Variadic functions can be called in the usual way with individual arguments.</p>
<p>If you already have multiple args in a slice, apply them to a variadic function using <code>func(slice...)</code> like this.</p>
<p>Another key aspect of functions in Go is their ability to form <em>closures (闭包 )</em> , which we’ll look at next.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run <span class="string">&#x27;.\13.Variadic Functions.go&#x27;</span>    </span><br><span class="line">[1 2] 3</span><br><span class="line">[1 2 3] 6</span><br><span class="line">[1 2 3 4] 10</span><br></pre></td></tr></table></figure>

<h2 id="Closures"><a href="#Closures" class="headerlink" title="Closures"></a>Closures</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Closures</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">intSeq</span><span class="params">()</span></span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    i := <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> <span class="type">int</span> &#123;</span><br><span class="line">        i++</span><br><span class="line">        <span class="keyword">return</span> i</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    nextInt := intSeq()</span><br><span class="line"></span><br><span class="line">    fmt.Println(nextInt())</span><br><span class="line">    fmt.Println(nextInt())</span><br><span class="line">    fmt.Println(nextInt())</span><br><span class="line"></span><br><span class="line">    newInts := intSeq()</span><br><span class="line">    fmt.Println(newInts())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Go supports <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Anonymous_function"><em>anonymous functions</em></a>, which can form <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Closure_(computer_science)"><em>closures</em></a>. Anonymous functions are useful when you want to define a function inline without having to name it.</p>
<p>This function <code>intSeq</code> returns another function, which we define anonymously in the body of <code>intSeq</code>. The returned function <em>closes over</em> the variable <code>i</code> to form a closure.</p>
<p>We call <code>intSeq</code>, assigning the result (a function) to <code>nextInt</code>. This function value captures its own <code>i</code> value, which will be updated each time we call <code>nextInt</code>.</p>
<p>See the effect of the closure by calling <code>nextInt</code> a few times.</p>
<p>To confirm that the state is unique to that particular function, create and test a new one.</p>
<p>The last feature of functions we’ll look at for now is recursion.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run <span class="string">&#x27;.\14.closures.go&#x27;</span>          </span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h2 id="Recursion"><a href="#Recursion" class="headerlink" title="Recursion"></a>Recursion</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Recursion</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fact</span><span class="params">(n <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> n * fact(n<span class="number">-1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(fact(<span class="number">7</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> fib <span class="function"><span class="keyword">func</span><span class="params">(n <span class="type">int</span>)</span></span> <span class="type">int</span></span><br><span class="line"></span><br><span class="line">    fib = <span class="function"><span class="keyword">func</span><span class="params">(n <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> n &lt; <span class="number">2</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> n</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> fib(n<span class="number">-1</span>) + fib(n<span class="number">-2</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fmt.Println(fib(<span class="number">7</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Go supports <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Recursion_(computer_science)"><em>recursive functions</em></a>. Here’s a classic example.</p>
<p>This <code>fact</code> function calls itself until it reaches the base case of <code>fact(0)</code>.</p>
<p>Anonymous functions can also be recursive, but this requires explicitly declaring a variable with <code>var</code> to store the function before it’s defined.</p>
<p>Since <code>fib</code> was previously declared in <code>main</code>, Go knows which function to call with <code>fib</code> here.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run <span class="string">&#x27;.\15.recursion.go&#x27;</span></span><br><span class="line">5040</span><br><span class="line">13</span><br></pre></td></tr></table></figure>

<h2 id="Range-over-Built-in-Types"><a href="#Range-over-Built-in-Types" class="headerlink" title="Range over Built-in Types"></a>Range over Built-in Types</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Range over Built-in Types</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	</span><br><span class="line">	nums := []<span class="type">int</span>&#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</span><br><span class="line">	sum := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> _, num := <span class="keyword">range</span> nums &#123;</span><br><span class="line">		sum += num</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;sum:&quot;</span>, sum)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i, num := <span class="keyword">range</span> nums &#123;</span><br><span class="line">		<span class="keyword">if</span> num == <span class="number">3</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;index:&quot;</span>, i)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	kvs := <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;<span class="string">&quot;a&quot;</span>: <span class="string">&quot;apple&quot;</span>, <span class="string">&quot;b&quot;</span>: <span class="string">&quot;banana&quot;</span>&#125;</span><br><span class="line">	<span class="keyword">for</span> k, v := <span class="keyword">range</span> kvs &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;%s -&gt; %s\n&quot;</span>, k, v)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> k := <span class="keyword">range</span> kvs &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;key:&quot;</span>, k)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i, c := <span class="keyword">range</span> <span class="string">&quot;go&quot;</span> &#123;	</span><br><span class="line">		fmt.Println(i, c)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>range</em> iterates over elements in a variety of built-in data structures. Let’s see how to use <code>range</code> with some of the data structures we’ve already learned.</p>
<p>Here we use <code>range</code> to sum the numbers in a slice. Arrays work like this too.</p>
<p><code>range</code> on arrays and slices provides both the index and value for each entry. Above we didn’t need the index, so we ignored it with the blank identifier <code>_</code>. Sometimes we actually want the indexes though.</p>
<p><code>range</code> on map iterates over key&#x2F;value pairs.</p>
<p><code>range</code> can also iterate over just the keys of a map.</p>
<p><code>range</code> on strings iterates over Unicode code points. The first value is the starting byte index of the <code>rune</code> and the second the <code>rune</code> itself. See [Strings and Runes](##Strings and Runes) for more details.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run <span class="string">&#x27;.\16.Range over Built-in Types.go&#x27;</span></span><br><span class="line"><span class="built_in">sum</span>: 9</span><br><span class="line">index: 1</span><br><span class="line">a -&gt; apple</span><br><span class="line">b -&gt; banana</span><br><span class="line">key: a</span><br><span class="line">key: b</span><br><span class="line">0 103</span><br><span class="line">1 111</span><br></pre></td></tr></table></figure>

<h2 id="Pointers"><a href="#Pointers" class="headerlink" title="Pointers"></a>Pointers</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Pointers</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">zeroval</span><span class="params">(ival <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">    ival = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">zeroptr</span><span class="params">(iptr *<span class="type">int</span>)</span></span> &#123;</span><br><span class="line">    *iptr = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    i := <span class="number">1</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;initial:&quot;</span>, i)</span><br><span class="line"></span><br><span class="line">    zeroval(i)</span><br><span class="line">    fmt.Println(<span class="string">&quot;zeroval:&quot;</span>, i)</span><br><span class="line"></span><br><span class="line">    zeroptr(&amp;i)</span><br><span class="line">    fmt.Println(<span class="string">&quot;zeroptr:&quot;</span>, i)</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;pointer:&quot;</span>, &amp;i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Go supports <em><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Pointer_(computer_programming)">pointers</a></em>, allowing you to pass references to values and records within your program.</p>
<p>We’ll show how pointers work in contrast to values with 2 functions: <code>zeroval</code> and <code>zeroptr</code>. <code>zeroval</code> has an <code>int</code> parameter, so arguments will be passed to it by value. <code>zeroval</code> will get a copy of <code>ival</code> distinct from the one in the calling function.</p>
<p><code>zeroptr</code> in contrast has an <code>*int</code> parameter, meaning that it takes an <code>int</code> pointer. The <code>*iptr</code> code in the function body then <em>dereferences</em> the pointer from its memory address to the current value at that address. Assigning a value to a dereferenced pointer changes the value at the referenced address.</p>
<p>The <code>&amp;i</code> syntax gives the memory address of <code>i</code>, i.e. a pointer to <code>i</code>.</p>
<p>Pointers can be printed too.</p>
<p><code>zeroval</code> doesn’t change the <code>i</code> in <code>main</code>, but <code>zeroptr</code> does because it has a reference to the memory address for that variable.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run <span class="string">&#x27;.\17.pointers.go&#x27;</span>                 </span><br><span class="line">initial: 1</span><br><span class="line">zeroval: 1</span><br><span class="line">zeroptr: 0</span><br><span class="line">pointer: 0xc00000a0d8</span><br></pre></td></tr></table></figure>

<h2 id="Strings-and-Runes"><a href="#Strings-and-Runes" class="headerlink" title="Strings and Runes"></a>Strings and Runes</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Strings and Runes</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;unicode/utf8&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> s = <span class="string">&quot;สวัสดี&quot;</span></span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;Len:&quot;</span>, <span class="built_in">len</span>(s))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(s); i++ &#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;%x &quot;</span>, s[i])</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println()</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;Rune count:&quot;</span>, utf8.RuneCountInString(s))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> idx, runeValue := <span class="keyword">range</span> s &#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;%#U starts at %d\n&quot;</span>, runeValue, idx)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;\nUsing DecodeRuneInString&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i, w := <span class="number">0</span>, <span class="number">0</span>; i &lt; <span class="built_in">len</span>(s); i += w &#123;</span><br><span class="line">        runeValue, width := utf8.DecodeRuneInString(s[i:])</span><br><span class="line">        fmt.Printf(<span class="string">&quot;%#U starts at %d\n&quot;</span>, runeValue, i)</span><br><span class="line">        w = width</span><br><span class="line"></span><br><span class="line">        examineRune(runeValue)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">examineRune</span><span class="params">(r <span class="type">rune</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> r == <span class="string">&#x27;t&#x27;</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;found tee&quot;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> r == <span class="string">&#x27;ส&#x27;</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;found so sua&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>A Go string is a <strong>read-only</strong> slice of bytes. The language and the standard library treat strings specially - as containers of text encoded in <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/UTF-8">UTF-8</a>. In other languages, strings are made of “characters”. In Go, the concept of a character is called a <code>rune</code> - it’s an integer that represents a Unicode code point. <a target="_blank" rel="noopener" href="https://go.dev/blog/strings">This Go blog post (maybe another blog)</a> is a good introduction to the topic.</p>
<p><code>s</code> is a <code>string</code> assigned a literal value representing the word “hello” in the Thai language. Go string literals are UTF-8 encoded text.</p>
<img src = "./goByExample-pt-2/001.png">

<p>Since strings are equivalent to <code>[]byte</code>, this will produce the length of the raw bytes stored within.</p>
<p>因为字符串等价于 <code>[]byte</code>， 这会产生存储在其中的原始字节的长度。</p>
<p>Indexing into a string produces the raw byte values at each index. This loop generates the hex values of all the bytes that constitute the code points in <code>s</code>.</p>
<p>To count how many <em>runes</em> are in a string, we can use the <code>utf8</code> package. Note that the run-time of <code>RuneCountInString</code> depends on the size of the string, because it has to decode each UTF-8 rune sequentially. Some Thai characters are represented by UTF-8 code points that can span multiple bytes, so the result of this count may be surprising.</p>
<p>要计算字符串中有多少rune，我们可以使用<code>utf8</code>包。 注意<code>RuneCountInString</code>的运行时取决于字符串的大小。 因为它必须按顺序解码每个 UTF-8 rune。 一些泰语字符由多个 UTF-8 code point 表示， 所以这个计数的结果可能会令人惊讶。</p>
<p>A <code>range</code> loop handles strings specially and decodes each <code>rune</code> along with its offset in the string.</p>
<p>We can achieve the same iteration by using the <code>utf8.DecodeRuneInString</code> function explicitly.</p>
<p>This demonstrates passing a <code>rune</code> value to a function.</p>
<p>Values enclosed in single quotes are <em>rune literals</em>. We can compare a <code>rune</code> value to a rune literal directly.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run <span class="string">&#x27;.\18.Strings and Runes.go&#x27;</span></span><br><span class="line">Len: 18</span><br><span class="line">e0 b8 aa e0 b8 a7 e0 b8 b1 e0 b8 aa e0 b8 94 e0 b8 b5</span><br><span class="line">Rune count: 6</span><br><span class="line">U+0E2A <span class="string">&#x27;ส&#x27;</span> starts at 0</span><br><span class="line">U+0E27 <span class="string">&#x27;ว&#x27;</span> starts at 3</span><br><span class="line">U+0E31 <span class="string">&#x27;ั&#x27;</span> starts at 6</span><br><span class="line">U+0E2A <span class="string">&#x27;ส&#x27;</span> starts at 9</span><br><span class="line">U+0E14 <span class="string">&#x27;ด&#x27;</span> starts at 12</span><br><span class="line">U+0E35 <span class="string">&#x27;ี&#x27;</span> starts at 15</span><br><span class="line"></span><br><span class="line">Using DecodeRuneInString</span><br><span class="line">U+0E2A <span class="string">&#x27;ส&#x27;</span> starts at 0</span><br><span class="line">found so sua</span><br><span class="line">U+0E27 <span class="string">&#x27;ว&#x27;</span> starts at 3</span><br><span class="line">U+0E31 <span class="string">&#x27;ั&#x27;</span> starts at 6</span><br><span class="line">U+0E2A <span class="string">&#x27;ส&#x27;</span> starts at 9</span><br><span class="line">found so sua</span><br><span class="line">U+0E14 <span class="string">&#x27;ด&#x27;</span> starts at 12</span><br><span class="line">U+0E35 <span class="string">&#x27;ี&#x27;</span> starts at 15</span><br></pre></td></tr></table></figure>

<h2 id="Structs"><a href="#Structs" class="headerlink" title="Structs"></a>Structs</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Structs</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> person <span class="keyword">struct</span> &#123;</span><br><span class="line">    name <span class="type">string</span></span><br><span class="line">    age  <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newPerson</span><span class="params">(name <span class="type">string</span>)</span></span> *person &#123;</span><br><span class="line"></span><br><span class="line">    p := person&#123;name: name&#125;</span><br><span class="line">    p.age = <span class="number">42</span></span><br><span class="line">    <span class="keyword">return</span> &amp;p</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    fmt.Println(person&#123;<span class="string">&quot;Bob&quot;</span>, <span class="number">20</span>&#125;)</span><br><span class="line"></span><br><span class="line">    fmt.Println(person&#123;name: <span class="string">&quot;Alice&quot;</span>, age: <span class="number">30</span>&#125;)</span><br><span class="line"></span><br><span class="line">    fmt.Println(person&#123;name: <span class="string">&quot;Fred&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">    fmt.Println(&amp;person&#123;name: <span class="string">&quot;Ann&quot;</span>, age: <span class="number">40</span>&#125;)</span><br><span class="line"></span><br><span class="line">    fmt.Println(newPerson(<span class="string">&quot;Jon&quot;</span>))</span><br><span class="line"></span><br><span class="line">    s := person&#123;name: <span class="string">&quot;Sean&quot;</span>, age: <span class="number">50</span>&#125;</span><br><span class="line">    fmt.Println(s.name)</span><br><span class="line"></span><br><span class="line">    sp := &amp;s</span><br><span class="line">    fmt.Println(sp.age)</span><br><span class="line"></span><br><span class="line">    sp.age = <span class="number">51</span></span><br><span class="line">    fmt.Println(sp.age)</span><br><span class="line"></span><br><span class="line">    dog := <span class="keyword">struct</span> &#123;</span><br><span class="line">        name   <span class="type">string</span></span><br><span class="line">        isGood <span class="type">bool</span></span><br><span class="line">    &#125;&#123;</span><br><span class="line">        <span class="string">&quot;Rex&quot;</span>,</span><br><span class="line">        <span class="literal">true</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(dog)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Go’s <em>structs</em> are typed collections of fields. They’re useful for grouping data together to form records.</p>
<p>This <code>person</code> struct type has <code>name</code> and <code>age</code> fields.</p>
<p><code>newPerson</code> constructs a new person struct with the given name.</p>
<p>Go is a garbage collected language; you can safely return a pointer to a local variable - it will only be cleaned up by the garbage collector when there are no active references to it.</p>
<p>This syntax creates a new struct.</p>
<p>You can name the fields when initializing a struct.</p>
<p>Omitted fields will be zero-valued.</p>
<p>An <code>&amp;</code> prefix yields a pointer to the struct.</p>
<p>It’s idiomatic to encapsulate new struct creation in constructor functions</p>
<p>在构造函数中封装创建新的结构实例是一种习惯用法</p>
<p>Access struct fields with a dot.</p>
<p>You can also use dots with struct pointers - the pointers are automatically dereferenced.</p>
<p>Structs are <em>mutable (可变的 )</em>.</p>
<p>If a struct type is only used for a single value, we don’t have to give it a name. The value can have an anonymous struct type. This technique is commonly used for <a target="_blank" rel="noopener" href="https://gobyexample.com/testing-and-benchmarking">table-driven tests (goByExample pt.8)</a>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run <span class="string">&#x27;.\19.structs.go&#x27;</span>          </span><br><span class="line">&#123;Bob 20&#125;</span><br><span class="line">&#123;Alice 30&#125;</span><br><span class="line">&#123;Fred 0&#125;</span><br><span class="line">&amp;&#123;Ann 40&#125;</span><br><span class="line">&amp;&#123;Jon 42&#125;</span><br><span class="line">Sean</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">&#123;Rex <span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Methods</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> rect <span class="keyword">struct</span> &#123;</span><br><span class="line">    width, height <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *rect)</span></span> area() <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> r.width * r.height</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r rect)</span></span> perim() <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>*r.width + <span class="number">2</span>*r.height</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := rect&#123;width: <span class="number">10</span>, height: <span class="number">5</span>&#125;</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;area: &quot;</span>, r.area())</span><br><span class="line">    fmt.Println(<span class="string">&quot;perim:&quot;</span>, r.perim())</span><br><span class="line"></span><br><span class="line">    rp := &amp;r</span><br><span class="line">    fmt.Println(<span class="string">&quot;area: &quot;</span>, rp.area())</span><br><span class="line">    fmt.Println(<span class="string">&quot;perim:&quot;</span>, rp.perim())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Go supports <em>methods</em> defined on struct types.</p>
<p>This <code>area</code> method has a <em>receiver type</em> of <code>*rect</code>.</p>
<p>Methods can be defined for either pointer or value receiver types. Here’s an example of a value receiver.</p>
<p>Here we call the 2 methods defined for our struct.</p>
<p>Go automatically handles conversion between values and pointers for method calls. You may want to use a pointer receiver type to avoid copying on method calls or to allow the method to mutate the receiving struct.</p>
<p>Next we’ll look at Go’s <em>mechanism (机制 )</em> for grouping and naming related sets of methods: interfaces.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">goByExample&gt; go run <span class="string">&#x27;.\20.Methods.go&#x27;</span></span><br><span class="line">area:  50</span><br><span class="line">perim: 30</span><br><span class="line">area:  50</span><br><span class="line">perim: 30</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-12-21T14:10:00.000Z" title="2024/12/21 22:10:00">2024-12-21</time>发表</span><span class="level-item"><time dateTime="2024-12-24T04:57:51.614Z" title="2024/12/24 12:57:51">2024-12-24</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Golang/">Golang</a><span> / </span><a class="link-muted" href="/categories/Golang/basics/">basics</a></span><span class="level-item">16 分钟读完 (大约2347个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/12/21/goByExample/goByExample-pt-1/">goByExample pt.1</a></p><div class="content"><h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/hello-world">Go by Example: hello-world</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To run the program, put the code in <code>hello-world.go</code> and use <code>go run</code>.</p>
<p>Sometimes we’ll want to build our programs into binaries. We can do this using <code>go build</code>.</p>
<p>We can then execute the built binary directly.</p>
<p>Now that we can run and build basic Go programs, let’s learn more about the language.</p>
<img src="./goByExample-pt-1/001 hello world.png">

<h2 id="Values"><a href="#Values" class="headerlink" title="Values"></a>Values</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/values">Go by Example: values</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// &quot;golang&quot;</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;go&quot;</span> + <span class="string">&quot;lang&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// &quot;1 + 1 = 2&quot;</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;1 + 1 =&quot;</span>, <span class="number">1</span> + <span class="number">1</span>)</span><br><span class="line">	<span class="comment">// &quot;7.0 / 3.0 = 2.3333333333333335&quot;</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;7.0 / 3.0 =&quot;</span>, <span class="number">7.0</span> / <span class="number">3.0</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// false</span></span><br><span class="line">	fmt.Println(<span class="literal">true</span> &amp;&amp; <span class="literal">false</span>)</span><br><span class="line">	<span class="comment">// true</span></span><br><span class="line">	fmt.Println(<span class="literal">true</span> || <span class="literal">false</span>)</span><br><span class="line">	<span class="comment">// false</span></span><br><span class="line">	fmt.Println(!<span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Go has various value types including strings, integers, floats, booleans, etc. Here are a few basic examples.</p>
<img src="./goByExample-pt-1/002 values.png">

<h2 id="Variables"><a href="#Variables" class="headerlink" title="Variables"></a>Variables</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Variables</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	<span class="keyword">var</span> a = <span class="string">&quot;initial&quot;</span></span><br><span class="line">	fmt.Println(a)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> b, c <span class="type">int</span>= <span class="number">1</span>, <span class="number">2</span></span><br><span class="line">	fmt.Println(b, c)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">var</span> d = <span class="literal">true</span></span><br><span class="line">	fmt.Println(d)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> e <span class="type">int</span></span><br><span class="line">	fmt.Println(e)</span><br><span class="line"></span><br><span class="line">	f := <span class="string">&quot;apple&quot;</span></span><br><span class="line">	fmt.Println(f)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In Go, <em>variables</em> are <strong>explicitly (明确的)</strong>  declared and used by the compiler to e.g. check type-correctness of function calls.</p>
<p><code>var</code> declares 1 or more variables.</p>
<p>You can declare multiple variables at once.</p>
<p>Go will infer the type of initialized variables.</p>
<p>Variables declared without a corresponding initialization are <em>zero-valued</em>. For example, the zero value for an <code>int</code> is <code>0</code>.</p>
<p>The <code>:=</code> syntax is shorthand for declaring and initializing a variable, e.g. for <code>var f string = &quot;apple&quot;</code> in this case. This syntax is only available inside functions.</p>
<img src="./goByExample-pt-1/003 variables.png">

<h2 id="Constants"><a href="#Constants" class="headerlink" title="Constants"></a>Constants</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Constants</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> s <span class="type">string</span> = <span class="string">&quot;constant&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	fmt.Println(s)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> n = <span class="number">500000000</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> d = <span class="number">3e20</span> / n</span><br><span class="line">	fmt.Println(d)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="type">int64</span>(d))</span><br><span class="line"></span><br><span class="line">	fmt.Println(math.Sin(n))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Go supports <em>constants</em> of character, string, boolean, and numeric (数学) values.</p>
<p><code>const</code> declares a constant value.</p>
<p>A <code>const</code> statement can appear anywhere a <code>var</code> statement can.</p>
<p>Constant expressions perform arithmetic (算数) with <em>arbitrary precision (任意精度)</em>.</p>
<p>A numeric constant has no type until it’s given one, such as by an explicit conversion (转换).</p>
<p>A number can be given a type by using it in a context that requires one, such as a variable assignment or function call. For example, here <code>math.Sin</code> expects a <code>float64</code>.</p>
<img src="./goByExample-pt-1/004 constants.png">

<h2 id="For"><a href="#For" class="headerlink" title="For"></a>For</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: For</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	</span><br><span class="line">	i := <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> i &lt;= <span class="number">3</span> &#123;</span><br><span class="line">		fmt.Println(i)</span><br><span class="line">		i = i + <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; <span class="number">3</span>; j++ &#123;</span><br><span class="line">		fmt.Println(j)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="keyword">range</span> <span class="number">3</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;range&quot;</span>, i)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;loop&quot;</span>)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> n := <span class="keyword">range</span> <span class="number">6</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(n)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>for</code> is Go’s only looping construct. Here are some basic types of <code>for</code> loops.</p>
<p>1st: The most basic type, with a single condition.</p>
<p>2nd: A classic initial&#x2F;condition&#x2F;after <code>for</code> loop.</p>
<p>3rd: Another way of accomplishing the basic “do this N times” iteration is <code>range</code> over an integer.</p>
<p>4th: <code>for</code> without a condition will loop repeatedly until you <code>break</code> out of the loop or <code>return</code> from the enclosing function.<strong>(the <code>while</code> in go)</strong></p>
<p>5th: You can also <code>continue</code> to the next iteration of the loop.</p>
<img src="./goByExample-pt-1/005 for.png">

<h2 id="If-Else"><a href="#If-Else" class="headerlink" title="If&#x2F;Else"></a>If&#x2F;Else</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: If&#x2F;Else</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">7</span>%<span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;7 is even&quot;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;7 is odd&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">8</span>%<span class="number">4</span> == <span class="number">0</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;8 is divisible by 4&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">8</span>%<span class="number">2</span> == <span class="number">0</span> || <span class="number">7</span>%<span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;either 8 or 7 are even&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> num := <span class="number">9</span>; num &lt; <span class="number">0</span> &#123;</span><br><span class="line">        fmt.Println(num, <span class="string">&quot;is negative&quot;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> num &lt; <span class="number">10</span> &#123;</span><br><span class="line">        fmt.Println(num, <span class="string">&quot;has 1 digit&quot;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fmt.Println(num, <span class="string">&quot;has multiple digits&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Branching with <code>if</code> and <code>else</code> in Go is straight-forward.</p>
<p>You can have an <code>if</code> statement without an else.</p>
<p>Logical operators like <code>&amp;&amp;</code> and <code>||</code> are often useful in conditions.</p>
<p>A statement can precede conditionals; any variables declared in this statement are available in the current and all subsequent branches.</p>
<p><em>语句可以位于条件之前；此语句中声明的任何变量均可在当前分支和所有后续分支中使用。</em></p>
<p>Note that you <strong>don’t</strong> need parentheses (小括号) around conditions in Go, but that the braces (大括号) are required.</p>
<p>There is no <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/%3F:">ternary if (三元运算符)</a> in Go, so you’ll need to use a full <code>if</code> statement even for basic conditions.</p>
<img src="./goByExample-pt-1/006 if else.png">

<h2 id="Switch"><a href="#Switch" class="headerlink" title="Switch"></a>Switch</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Switch</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    i := <span class="number">2</span></span><br><span class="line">    fmt.Print(<span class="string">&quot;Write &quot;</span>, i, <span class="string">&quot; as &quot;</span>)</span><br><span class="line">    <span class="keyword">switch</span> i &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;one&quot;</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;two&quot;</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;three&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> time.Now().Weekday() &#123;</span><br><span class="line">    <span class="keyword">case</span> time.Saturday, time.Sunday:</span><br><span class="line">        fmt.Println(<span class="string">&quot;It&#x27;s the weekend&quot;</span>)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;It&#x27;s a weekday&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    t := time.Now()</span><br><span class="line">    <span class="keyword">switch</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> t.Hour() &lt; <span class="number">12</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;It&#x27;s before noon&quot;</span>)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;It&#x27;s after noon&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    whatAmI := <span class="function"><span class="keyword">func</span><span class="params">(i <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> t := i.(<span class="keyword">type</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="type">bool</span>:</span><br><span class="line">            fmt.Println(<span class="string">&quot;I&#x27;m a bool&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="type">int</span>:</span><br><span class="line">            fmt.Println(<span class="string">&quot;I&#x27;m an int&quot;</span>)</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            fmt.Printf(<span class="string">&quot;Don&#x27;t know type %T\n&quot;</span>, t)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    whatAmI(<span class="literal">true</span>)</span><br><span class="line">    whatAmI(<span class="number">1</span>)</span><br><span class="line">    whatAmI(<span class="string">&quot;hey&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>Switch statements</em> express conditionals across many branches.</p>
<p>You can use commas to separate multiple expressions in the same <code>case</code> statement. We use the optional <code>default</code> case in this example as well.</p>
<p><code>switch</code> without an expression is an alternate way to express if&#x2F;else logic. Here we also show how the <strong><code>case</code> expressions can be non-constants (case 表达式如何可以是非常量)</strong>.</p>
<p>A type <code>switch</code> compares types instead of values. You can use this to discover the type of an interface value. In this example, the variable <code>t</code> will have the type corresponding to its clause.</p>
<img src="./goByExample-pt-1/007 switch.png">

<h2 id="Arrays"><a href="#Arrays" class="headerlink" title="Arrays"></a>Arrays</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Arrays</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// a: 0 0 0 0 0</span></span><br><span class="line">    <span class="keyword">var</span> a [<span class="number">5</span>]<span class="type">int</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;emp:&quot;</span>, a)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// a: 0 0 0 0 100 </span></span><br><span class="line">    a[<span class="number">4</span>] = <span class="number">100</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;set:&quot;</span>, a)</span><br><span class="line">    fmt.Println(<span class="string">&quot;get:&quot;</span>, a[<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;len:&quot;</span>, <span class="built_in">len</span>(a))</span><br><span class="line"></span><br><span class="line">	<span class="comment">// b: 1 2 3 4 5</span></span><br><span class="line">    b := [<span class="number">5</span>]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">    fmt.Println(<span class="string">&quot;dcl:&quot;</span>, b)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// b: 1 2 3 4 5</span></span><br><span class="line">	<span class="comment">// len = 5</span></span><br><span class="line">    b = [...]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">    fmt.Println(<span class="string">&quot;dcl:&quot;</span>, b)</span><br><span class="line"></span><br><span class="line">    b = [...]<span class="type">int</span>&#123;<span class="number">100</span>, <span class="number">3</span>: <span class="number">400</span>, <span class="number">500</span>&#125;</span><br><span class="line">    fmt.Println(<span class="string">&quot;idx:&quot;</span>, b)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> twoD [<span class="number">2</span>][<span class="number">3</span>]<span class="type">int</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">2</span>; i++ &#123;</span><br><span class="line">        <span class="keyword">for</span> j := <span class="number">0</span>; j &lt; <span class="number">3</span>; j++ &#123;</span><br><span class="line">            twoD[i][j] = i + j</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(<span class="string">&quot;2d: &quot;</span>, twoD)</span><br><span class="line"></span><br><span class="line">    twoD = [<span class="number">2</span>][<span class="number">3</span>]<span class="type">int</span>&#123;</span><br><span class="line">        &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;,</span><br><span class="line">        &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(<span class="string">&quot;2d: &quot;</span>, twoD)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In Go, an <em>array</em> is a <strong>numbered sequence</strong> of elements of a specific length. In typical Go code, <a target="_blank" rel="noopener" href="https://gobyexample.com/slices">slices (the next)</a> are much more common; arrays are useful in some special scenarios (场景).</p>
<p>Here we create an array <code>a</code> that will hold exactly 5 <code>int</code>s. The type of elements and length are both part of the array’s type. By default an array is zero-valued, which for <code>int</code>s means <code>0</code>s.</p>
<p>We can set a value at an index using the <code>array[index] = value</code> syntax, and get a value with <code>array[index]</code>.</p>
<p>The builtin <code>len</code> returns the length of an array.</p>
<p>Use this syntax to declare and initialize an array in one line.</p>
<p>You can also have the compiler count the number of elements for you with <code>...</code></p>
<p>If you specify the index with <code>:</code>, the elements in between will be zeroed.</p>
<p><strong>如果使用 <code>:</code> 指定索引，则其间的元素将被清零</strong></p>
<p><strong><code>b = [...]int&#123;100, 3: 400, 500&#125;</code></strong></p>
<ul>
<li><p><code>[...]int</code> 表示一个整数类型的数组，Go会根据初始化时的元素数量自动推断数组的大小。</p>
</li>
<li><p><code>100</code> 赋值给数组的第一个位置，<code>b[0] = 100</code>。</p>
</li>
<li><p><code>3: 400</code> 表示将数组的索引 <code>3</code> 设置为 <code>400</code>，即 <code>b[3] = 400</code>。这里使用了<strong>索引赋值</strong>的语法：<code>索引:值</code>，它将数组的特定位置初始化为给定的值。</p>
</li>
<li><p><code>500</code> 会自动赋值给数组的最后一个位置，也就是 <code>b[4] = 500</code>。</p>
</li>
</ul>
<p>Array types are <strong>one-dimensional</strong>, but you can compose types to build multi-dimensional data structures.</p>
<p>You can create and initialize multi-dimensional arrays at once too.</p>
<img src="./goByExample-pt-1/008 arrays.png">

<p>Note that arrays appear in the form <code>[v1 v2 v3 ...]</code> when printed with <code>fmt.Println</code>.</p>
<h2 id="Slices"><a href="#Slices" class="headerlink" title="Slices"></a>Slices</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Slices</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;slices&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> s []<span class="type">string</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;uninit:&quot;</span>, s, s == <span class="literal">nil</span>, <span class="built_in">len</span>(s) == <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    s = <span class="built_in">make</span>([]<span class="type">string</span>, <span class="number">3</span>)</span><br><span class="line">    fmt.Println(<span class="string">&quot;emp:&quot;</span>, s, <span class="string">&quot;len:&quot;</span>, <span class="built_in">len</span>(s), <span class="string">&quot;cap:&quot;</span>, <span class="built_in">cap</span>(s))</span><br><span class="line"></span><br><span class="line">    s[<span class="number">0</span>] = <span class="string">&quot;a&quot;</span></span><br><span class="line">    s[<span class="number">1</span>] = <span class="string">&quot;b&quot;</span></span><br><span class="line">    s[<span class="number">2</span>] = <span class="string">&quot;c&quot;</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;set:&quot;</span>, s)</span><br><span class="line">    fmt.Println(<span class="string">&quot;get:&quot;</span>, s[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;len:&quot;</span>, <span class="built_in">len</span>(s))</span><br><span class="line"></span><br><span class="line">    s = <span class="built_in">append</span>(s, <span class="string">&quot;d&quot;</span>)</span><br><span class="line">    s = <span class="built_in">append</span>(s, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>)</span><br><span class="line">    fmt.Println(<span class="string">&quot;apd:&quot;</span>, s)</span><br><span class="line"></span><br><span class="line">    c := <span class="built_in">make</span>([]<span class="type">string</span>, <span class="built_in">len</span>(s))</span><br><span class="line">    <span class="built_in">copy</span>(c, s)</span><br><span class="line">    fmt.Println(<span class="string">&quot;cpy:&quot;</span>, c)</span><br><span class="line"></span><br><span class="line">    l := s[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">    fmt.Println(<span class="string">&quot;sl1:&quot;</span>, l)</span><br><span class="line"></span><br><span class="line">    l = s[:<span class="number">5</span>]</span><br><span class="line">    fmt.Println(<span class="string">&quot;sl2:&quot;</span>, l)</span><br><span class="line"></span><br><span class="line">    l = s[<span class="number">2</span>:]</span><br><span class="line">    fmt.Println(<span class="string">&quot;sl3:&quot;</span>, l)</span><br><span class="line"></span><br><span class="line">    t := []<span class="type">string</span>&#123;<span class="string">&quot;g&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;i&quot;</span>&#125;</span><br><span class="line">    fmt.Println(<span class="string">&quot;dcl:&quot;</span>, t)</span><br><span class="line"></span><br><span class="line">    t2 := []<span class="type">string</span>&#123;<span class="string">&quot;g&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;i&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">if</span> slices.Equal(t, t2) &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;t == t2&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    twoD := <span class="built_in">make</span>([][]<span class="type">int</span>, <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">3</span>; i++ &#123;</span><br><span class="line">        innerLen := i + <span class="number">1</span></span><br><span class="line">        twoD[i] = <span class="built_in">make</span>([]<span class="type">int</span>, innerLen)</span><br><span class="line">        <span class="keyword">for</span> j := <span class="number">0</span>; j &lt; innerLen; j++ &#123;</span><br><span class="line">            twoD[i][j] = i + j</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(<span class="string">&quot;2d: &quot;</span>, twoD)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>Slices</em> are an important data type in Go, giving a <strong>more powerful</strong> interface to sequences than arrays.</p>
<p>Unlike arrays, slices are typed only by the elements they contain (not the number of elements). An uninitialized slice equals to <code>nil</code> and has length 0.</p>
<p>To create an empty slice with non-zero length, use the builtin <code>make</code>. Here we make a slice of <code>string</code>s of length <code>3</code> (initially zero-valued). By default a new slice’s capacity is equal to its length; if we know the slice is going to grow ahead of time, it’s possible to pass a capacity explicitly as an additional parameter to <code>make</code>.</p>
<p>We can set and get just like with arrays.</p>
<p><code>len</code> returns the length of the slice as expected.</p>
<p>In addition to these basic operations, slices support several more that make them richer than arrays. One is the builtin <code>append</code>, which returns a slice containing one or more new values. Note that we need to accept a return value from <code>append</code> as we may get a new slice value.</p>
<p>Slices can also be <code>copy</code>’d. Here we create an empty slice <code>c</code> of the same length as <code>s</code> and copy into <code>c</code> from <code>s</code>.</p>
<p>Slices support a “slice” operator with the syntax <code>slice[low:high]</code>. For example, this gets a slice of the elements <code>s[2]</code>, <code>s[3]</code>, and <code>s[4]</code>.</p>
<p>This slices up to (but excluding) <code>s[5]</code>.</p>
<p>And this slices up from (and including) <code>s[2]</code>.</p>
<p>We can declare and initialize a variable for slice in a single line as well.</p>
<p>The <code>slices</code> package contains a number of useful utility functions for slices.</p>
<p>Slices can be composed into multi-dimensional data structures. The length of the inner slices can vary, unlike with multi-dimensional arrays.</p>
<img src="./goByExample-pt-1/009 slices.png">

<p>Note that while slices are different types than arrays, they are rendered (呈现) similarly by <code>fmt.Println</code>.</p>
<p>Check out this <a target="_blank" rel="noopener" href="https://go.dev/blog/slices-intro">great blog post (maybe in another blog)</a> by the Go team for more details on the design and implementation of slices in Go.<br>Now that we’ve seen arrays and slices we’ll look at Go’s other key builtin data structure: maps. </p>
<h2 id="Maps"><a href="#Maps" class="headerlink" title="Maps"></a>Maps</h2><p><a target="_blank" rel="noopener" href="https://gobyexample.com/">Go by Example: Maps</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;maps&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span>)</span><br><span class="line"></span><br><span class="line">    m[<span class="string">&quot;k1&quot;</span>] = <span class="number">7</span></span><br><span class="line">    m[<span class="string">&quot;k2&quot;</span>] = <span class="number">13</span></span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;map:&quot;</span>, m)</span><br><span class="line"></span><br><span class="line">    v1 := m[<span class="string">&quot;k1&quot;</span>]</span><br><span class="line">    fmt.Println(<span class="string">&quot;v1:&quot;</span>, v1)</span><br><span class="line"></span><br><span class="line">    v3 := m[<span class="string">&quot;k3&quot;</span>]</span><br><span class="line">    fmt.Println(<span class="string">&quot;v3:&quot;</span>, v3)</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;len:&quot;</span>, <span class="built_in">len</span>(m))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">delete</span>(m, <span class="string">&quot;k2&quot;</span>)</span><br><span class="line">    fmt.Println(<span class="string">&quot;map:&quot;</span>, m)</span><br><span class="line"></span><br><span class="line">    clear(m)</span><br><span class="line">    fmt.Println(<span class="string">&quot;map:&quot;</span>, m)</span><br><span class="line"></span><br><span class="line">    _, prs := m[<span class="string">&quot;k2&quot;</span>]</span><br><span class="line">    fmt.Println(<span class="string">&quot;prs:&quot;</span>, prs)</span><br><span class="line"></span><br><span class="line">    n := <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span>&#123;<span class="string">&quot;foo&quot;</span>: <span class="number">1</span>, <span class="string">&quot;bar&quot;</span>: <span class="number">2</span>&#125;</span><br><span class="line">    fmt.Println(<span class="string">&quot;map:&quot;</span>, n)</span><br><span class="line"></span><br><span class="line">    n2 := <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span>&#123;<span class="string">&quot;foo&quot;</span>: <span class="number">1</span>, <span class="string">&quot;bar&quot;</span>: <span class="number">2</span>&#125;</span><br><span class="line">    <span class="keyword">if</span> maps.Equal(n, n2) &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;n == n2&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>Maps</em> are Go’s built-in <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Associative_array">associative data type (内置关联数据类型)</a> (sometimes called <em>hashes</em> or <em>dicts</em> in other languages).</p>
<p>To create an empty map, use the builtin <code>make</code>: <code>make(map[key-type]val-type)</code>.</p>
<p>Set key&#x2F;value pairs using typical <code>name[key] = val</code> syntax.</p>
<p>Printing a map with e.g. <code>fmt.Println</code> will show all of its key&#x2F;value pairs.</p>
<p>Get a value for a key with <code>name[key]</code>.</p>
<p>If the key doesn’t exist, the <a target="_blank" rel="noopener" href="https://go.dev/ref/spec#The_zero_value">zero value (maybe another blog)</a> of the value type is returned.</p>
<p>The builtin <code>len</code> returns the number of key&#x2F;value pairs when called on a map.</p>
<p>The builtin <code>delete</code> removes key&#x2F;value pairs from a map.</p>
<p>To remove <em>all</em> key&#x2F;value pairs from a map, use the <code>clear</code> builtin.</p>
<p>The optional second return value when getting a value from a map indicates if the key was present in the map. This can be used to disambiguate between missing keys and keys with zero values like <code>0</code> or <code>&quot;&quot;</code>. Here we didn’t need the value itself, so we ignored it with the <em>blank identifier</em> <code>_</code>.</p>
<p>当从一个 map 中取值时，还有可以选择是否接收的第二个返回值，该值表明了 map 中是否存在这个键。 这可以用来消除 <code>键不存在</code> 和 <code>键的值为零值</code> 产生的歧义， 例如 <code>0</code> 和 <code>&quot;&quot;</code>。这里我们不需要值，所以用 <em>空白标识符(blank identifier)</em> _ 将其忽略。</p>
<p>You can also declare and initialize a new map in the same line with this syntax.</p>
<p>The <code>maps</code> package contains a number of useful utility functions for maps.</p>
<img src="./goByExample-pt-1/010 maps.png">

<p>Note that maps appear in the form <code>map[k:v k:v]</code> when printed with <code>fmt.Println</code>.</p>
<p>next part: <a href="/2024/12/23/goByExample-pt-2/">goByExample pt.2</a></p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.jpg" alt="Rossignol"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Rossignol</p><p class="is-size-6 is-block">NaN</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Mars</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">12</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">9</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">10</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/0xRossignol" target="_blank" rel="me noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/0xRossignol"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Golang/"><span class="level-start"><span class="level-item">Golang</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/Golang/basics/"><span class="level-start"><span class="level-item">basics</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/Java/basics/"><span class="level-start"><span class="level-item">basics</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/OS/"><span class="level-start"><span class="level-item">OS</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Software-Construction/"><span class="level-start"><span class="level-item">Software Construction</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/Software-Construction/MIT6-031/"><span class="level-start"><span class="level-item">MIT6.031</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/TypeScript/"><span class="level-start"><span class="level-item">TypeScript</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/test/"><span class="level-start"><span class="level-item">test</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-02-11T05:54:56.000Z">2025-02-11</time></p><p class="title"><a href="/2025/02/11/Thinking-in-Java/Thinking-in-Java-pt-3/">Thinking in Java pt.3</a></p><p class="categories"><a href="/categories/Java/">Java</a> / <a href="/categories/Java/basics/">basics</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-02-10T05:20:00.000Z">2025-02-10</time></p><p class="title"><a href="/2025/02/10/Thinking-in-Java/Thinking-in-Java-pt-2/">Thinking in Java pt.2</a></p><p class="categories"><a href="/categories/Java/">Java</a> / <a href="/categories/Java/basics/">basics</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-02-09T02:54:56.000Z">2025-02-09</time></p><p class="title"><a href="/2025/02/09/Thinking-in-Java/Thinking-in-Java-pt-1/">Thinking in Java pt.1</a></p><p class="categories"><a href="/categories/Java/">Java</a> / <a href="/categories/Java/basics/">basics</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-01-28T07:39:54.000Z">2025-01-28</time></p><p class="title"><a href="/2025/01/28/MIT6.031/Readings/02_Basic_TypeScript/">Reading 2-Basic TypeScript</a></p><p class="categories"><a href="/categories/TypeScript/">TypeScript</a> / <a href="/categories/Software-Construction/">Software Construction</a> / <a href="/categories/Software-Construction/MIT6-031/">MIT6.031</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-01-25T09:00:00.000Z">2025-01-25</time></p><p class="title"><a href="/2025/01/25/MIT6.031/Readings/01_Static_Checking/">Reading 1-Static Checking</a></p><p class="categories"><a href="/categories/TypeScript/">TypeScript</a> / <a href="/categories/Software-Construction/">Software Construction</a> / <a href="/categories/Software-Construction/MIT6-031/">MIT6.031</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/02/"><span class="level-start"><span class="level-item">二月 2025</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/01/"><span class="level-start"><span class="level-item">一月 2025</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/12/"><span class="level-start"><span class="level-item">十二月 2024</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/English/"><span class="tag">English</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Golang/"><span class="tag">Golang</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OS/"><span class="tag">OS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Software-Construction/"><span class="tag">Software Construction</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TypeScript/"><span class="tag">TypeScript</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/test/"><span class="tag">test</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B8%AD%E6%96%87/"><span class="tag">中文</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B1%87%E7%BC%96/"><span class="tag">汇编</span><span class="tag">2</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="MyBlog" height="28"></a><p class="is-size-7"><span>&copy; 2025 Rossignol</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>